<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Skrunks Calculator Web Suite</title>
<style>body{font-family:Arial,sans-serif;max-width:800px;margin:0 auto;padding:0 10px;background:#fff;color:#000;line-height:1.6}.nav-bar{display:flex;justify-content:center;background:#007bff;padding:5px 0;margin-bottom:15px;border-radius:0 0 8px 8px}.nav-button{background:transparent;color:#fff;border:none;padding:5px 15px;margin:0 3px;font-size:14px;cursor:pointer;border-radius:4px;transition:background-color .3s}.multiline-nav-button{line-height:1.2;padding-top:2px;padding-bottom:2px}.small-text{font-size:12px;display:block}.nav-button:hover{background:rgba(255,255,255,.2)}.nav-button.active{background:rgba(255,255,255,.3);font-weight:700}h2,h3{text-align:center;color:#007bff}fieldset{margin-bottom:10px;border:1px solid #ccc;padding:10px;border-radius:5px}button{margin:5px;padding:8px 12px;font-size:16px;background:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer}button:hover{background:#0056b3}input[type=number]{padding:8px;font-size:16px;border:1px solid #ccc;border-radius:5px;width:100%;box-sizing:border-box}.grid{width:100%;border-collapse:collapse;margin-bottom:10px;overflow-x:auto;display:block}.grid th,.grid td{border:1px solid #ddd;padding:8px;text-align:center}.grid th{background:#f2f2f2}#resultOutput{background:#f9f9f9;border:1px solid #ccc;padding:10px;white-space:pre-wrap;height:150px;overflow:auto;border-radius:5px}.tcr-container{background:#fff;padding:2em;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,.1);max-width:500px;margin:0 auto;text-align:center}.saved-calculations{margin-top:20px;padding:10px;background:#e9ecef;border-radius:5px;text-align:left}.delete-btn{color:#777;cursor:pointer;margin-left:10px;font-weight:700}.delete-btn:hover{color:red}.module{display:none}.module.active{display:block}.submission-form{background:#e9ecef;padding:20px;border-radius:10px;margin-bottom:20px;max-width:500px;margin:0 auto}.submission-form input,.submission-form select,.submission-form textarea{width:100%;margin-bottom:10px;padding:8px;font-size:16px;border:1px solid #ccc;border-radius:5px;box-sizing:border-box}.image-repo-controls{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding:10px;background:#f2f2f2;border-radius:5px}.filter-container{display:flex;align-items:center}.filter-container label{margin-right:10px}#dimensionFilter{padding:8px;border-radius:5px;border:1px solid #ccc}.image-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:15px;padding:10px}.image-card{border:1px solid #ddd;border-radius:5px;overflow:hidden;transition:transform .3s;display:flex;flex-direction:column;height:fit-content}.image-card:hover{transform:scale(1.03);box-shadow:0 4px 8px rgba(0,0,0,.1)}.image-card img{width:100%;height:auto;display:block;object-fit:contain}.image-info{padding:10px;font-size:14px;background:#f9f9f9}.download-btn{margin:0 10px 10px;padding:6px 10px;background:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:14px;transition:background-color .3s}.download-btn:hover{background:#0056b3}.scroll-to-top{position:fixed;bottom:20px;right:30px;z-index:99;width:40px;height:40px;background:#007bff;color:#fff;border:none;border-radius:50%;cursor:pointer;opacity:0;transition:opacity .3s,background-color .3s;display:flex;justify-content:center;align-items:center;box-shadow:0 2px 5px rgba(0,0,0,.3);pointer-events:none}.scroll-to-top.visible{opacity:.8;pointer-events:auto}.scroll-to-top:hover{opacity:1;background:#0056b3}.scroll-to-top::after{content:"^";font-size:30px;font-weight:700;line-height:.75;position:relative;top:4px}body.dark-mode{background:#121212;color:#e0e0e0}body.dark-mode .warning,body.dark-mode h2,body.dark-mode h3{color:#66b2ff}body.dark-mode .nav-bar{background:#0056b3}body.dark-mode .grid th{background:#1e1e1e}body.dark-mode .grid,body.dark-mode .grid th,body.dark-mode .grid td{border:1px solid #333}body.dark-mode #resultOutput{background:#1e1e1e;border:1px solid #444}body.dark-mode input[type=number],body.dark-mode input[type=text],body.dark-mode input[type=date],body.dark-mode select,body.dark-mode textarea{border:1px solid #444;background:#333;color:#e0e0e0}body.dark-mode input[type=number][readonly]{background:#2a2a2a}body.dark-mode button{background:#0056b3}body.dark-mode button:hover{background:#003d80}body.dark-mode .tcr-container{background:#2c2c2c;box-shadow:0 0 10px rgba(0,0,0,.5)}body.dark-mode .saved-calculations{background:#333}body.dark-mode .delete-btn{color:#bbb}body.dark-mode .submission-form{background:#2c2c2c}body.dark-mode .image-repo-controls{background:#2c2c2c}body.dark-mode #dimensionFilter{background:#333;color:#e0e0e0;border-color:#444}body.dark-mode .image-card{border-color:#444}body.dark-mode .image-card:hover{box-shadow:0 4px 8px rgba(0,0,0,.5)}body.dark-mode .image-info{background:#1e1e1e}body.dark-mode .download-btn{background:#0056b3}body.dark-mode .download-btn:hover{background:#003d80}body.dark-mode .scroll-to-top{background:#0056b3}body.dark-mode .scroll-to-top:hover{background:#003d80}@media (max-width:600px){body{font-size:14px}button{font-size:14px;padding:6px 10px}input[type=number]{font-size:14px}.grid th,.grid td{padding:6px}fieldset{padding:8px}.nav-button{padding:4px 10px;font-size:13px}}</style>
</head>
<body>
<div class="nav-bar"><button class="nav-button" id="tfrNavBtn">Skrunks Easy TFR Curve</button><button class="nav-button active" id="tcrNavBtn">Skrunks Easy TCR Burnoff</button><button class="nav-button multiline-nav-button" id="submitNavBtn">Submit TFR<br><span class="small-text">(Show Skrunk your curves)</span></button><button class="nav-button" id="imageRepoNavBtn">Skrunk Image Repo</button><button class="nav-button" id="darkModeToggle">🌙</button></div>
<div id="tfrModule" class="module">
<h2>Skrunks Web TFR Calc</h2>
<div style="text-align:center;margin-bottom:10px;"><button id="tfrGuideButton">TFR Guide</button></div>
<fieldset><legend>Curve Type</legend><label><input type="radio" name="curveType" value="7pt" checked> 7‑Point Curve</label> <label><input type="radio" name="curveType" value="8pt"> 8‑Point Curve</label> <label><input type="radio" name="curveType" value="tsm"> TSM Fix Mode</label> <label><input type="radio" name="curveType" value="auto"> Auto TFR Clean</label></fieldset>
<div id="extrapolateContainer" style="text-align:center;margin-bottom:10px;"><label><input type="checkbox" id="extrapolateCheck"> Extrapolate 800°F value</label></div>
<div style="text-align:center;margin-bottom:10px;"><button id="tempUnitToggle">°F / °C</button> <button id="importButton">Import CSV</button> <button id="exportButton">Export CSV</button> <input type="file" id="csvFileInput" accept=".csv" style="display:none;"></div>
<div style="overflow-x:auto;"><table class="grid" id="gridContainer"></table></div>
<div style="text-align:center;margin-bottom:10px;"><button id="calcButton">Calculate TFR</button></div>
<h3>Results:</h3>
<pre id="resultOutput"></pre>
</div>
<div id="tcrModule" class="module active">
<div class="tcr-container">
<h2>Tcr burnoff calc</h2>
<p>Enter your cold resistance (in ohms) below. This calculator assumes that at 600°F your device's resistance will be 0.79 Ω as required for burnoffs.</p>
<label for="coldRes">Cold Resistance (Ω): </label><input type="number" id="coldRes" step="any">
<button id="tcrCalcButton">Calculate</button>
<p class="warning"><strong>Warning:</strong> This tool performs standardized math for the temperature coefficient of resistance and then subtracts 3. While this should be accurate for all devices, it may not be accurate for yours. As such, Skrunk is not responsible for any damaged cups or mods that may occur due to the use of this calculator.</p>
<h3>Result</h3>
<p id="tcrResult"></p>
<h3>Saved Calculations</h3>
<div id="savedCalculations" class="saved-calculations"></div>
</div>
</div>
<div id="submitModule" class="module">
<div class="submission-form">
<h2>Submit Your TFR Curve</h2>
<iframe src="https://docs.google.com/forms/d/e/1FAIpQLScSHdM6HtYnTjNJg4ZMBefj7amE1tOi5I1WmrxH22attDVZtw/viewform?embedded=true" scrolling="no" width="499" height="1299" frameborder="0" marginheight="0" marginwidth="0">Loading…</iframe>
</div>
</div>
<div id="imageRepoModule" class="module">
<h2>Skrunk Image Repository</h2>
<div class="image-repo-controls">
<div class="filter-container"><label for="dimensionFilter">Filter by dimensions:</label><select id="dimensionFilter"><option value="all">All Images</option></select></div>
<button id="refreshImagesBtn">Refresh Images</button>
</div>
<div id="imageContainer" class="image-grid"><p id="loadingImages">Loading images...</p></div>
<button id="scrollToTopBtn" class="scroll-to-top" title="Go to top"></button>
</div>
<script>
const temperatureSets={'7pt':[70,200,300,400,500,570,800],'8pt':[-40,70,200,300,400,500,570,800],'tsm':[-40,70,200,220,300,500,570,800],'auto':[70,200,300,400,500,600,800]};
let currentType='7pt',currentTemperatures=temperatureSets[currentType],tempInputs={},resInputs={},calculatedCoefficients=[],isCelsius=!1,cachedImages=[];
function fahrenheitToCelsius(e){return Math.round((e-32)*5/9)}
function celsiusToFahrenheit(e){return Math.round(e*9/5+32)}
function toggleTemperatureUnit(){const e={};currentTemperatures.forEach(t=>{resInputs[t]&&(e[t]=resInputs[t].value)}),isCelsius=!isCelsius,updateGrid(e)}
function updateGrid(e=null){tempInputs={},resInputs={};const t=document.getElementById("gridContainer");t.innerHTML="";const n=document.createElement("tr"),r=document.createElement("th");r.innerText=`Temperature (${isCelsius?"°C":"°F"})`;const a=document.createElement("th");a.innerText="Resistance Value",n.appendChild(r),n.appendChild(a),t.appendChild(n),currentTemperatures.forEach(n=>{const r=document.createElement("tr"),a=document.createElement("td"),s=isCelsius?fahrenheitToCelsius(n):n;if("tsm"===currentType)if(n===-40||n===70||n===200||n===220)a.innerText=s,a.dataset.fahrenheit=n;else{const e=document.createElement("input");e.type="number",e.value=s,e.step="1",e.dataset.fahrenheit=n,a.appendChild(e),tempInputs[n]=e}else if("auto"===currentType)a.innerText=s,a.dataset.fahrenheit=n;else{const e=document.createElement("input");e.type="number",e.value=s,e.step="1",e.dataset.fahrenheit=n,a.appendChild(e),tempInputs[n]=e}r.appendChild(a);const i=document.createElement("td"),o=document.createElement("input");if(o.type="number",o.step="0.001","tsm"===currentType){if(n===-40||n===200&&(o.readOnly=!0,o.style.backgroundColor="#f0f0f0"),n===70)o.addEventListener("input",updateTSMValues)}else if("auto"===currentType)if(n===70)o.addEventListener("input",autoFillValues);else{o.readOnly=!0,o.style.backgroundColor="#f0f0f0"}e&&void 0!==e[n]&&(o.value=e[n]),n===800&&document.getElementById("extrapolateCheck").checked&&(o.readOnly=!0,o.style.backgroundColor="#f0f0f0"),i.appendChild(o),r.appendChild(i),resInputs[n]=o,t.appendChild(r)}),setTimeout(setupExtrapolationListeners,0)}
function displaySavedCalculations(){var e=JSON.parse(localStorage.getItem("calculations"))||[],t=document.getElementById("savedCalculations");t&&(t.innerHTML=e.map((e,t)=>`Cold Resistance: ${e.coldRes} Ω - Required TCR: ${e.tcrFull} <span class="delete-btn" onclick="deleteCalculation(${t})">&times;</span>`).join("<br>"))}
function showModule(e){document.querySelectorAll(".module").forEach(e=>e.classList.remove("active")),document.getElementById(e).classList.add("active")}
function updateNavButtons(e){document.querySelectorAll(".nav-button").forEach(t=>{t.id===e?t.classList.add("active"):t.id!=="darkModeToggle"&&t.classList.remove("active")})}
function applyDarkMode(){const e=localStorage.getItem("darkMode")!=="false";if(e){document.body.classList.add("dark-mode");const t=document.getElementById("darkModeToggle");t&&(t.textContent="🌙")}else{document.body.classList.remove("dark-mode");const t=document.getElementById("darkModeToggle");t&&(t.textContent="☀️")}}
function autoFillValues(){if("auto"!==currentType)return;const e=parseFloat(resInputs[70].value);if(isNaN(e)||e<=0)return;const t=e+.001,n=.79,r=1.2*n;currentTemperatures.forEach(a=>{if(70===a)return;let s;if(a===200)s=t;else if(a===600)s=n;else if(a===800)s=r;else{const e=(a-200)/(600-200),r=Math.pow(e,2);s=t+(n-t)*r}resInputs[a].value=s.toFixed(3)})}
function updateTSMValues(){if("tsm"!==currentType)return;const e=parseFloat(resInputs[70].value);if(isNaN(e)||e<=0)return;const t=.92*e;resInputs[-40].value=t.toFixed(3),resInputs[200].value=(e+.001).toFixed(3)}
function calculateTFR(){if("auto"===currentType?autoFillValues():"tsm"===currentType&&updateTSMValues(),temps=[],currentTemperatures.forEach(e=>{if(tempInputs[e]){let t=parseFloat(tempInputs[e].value);isCelsius&&!isNaN(t)&&(t=celsiusToFahrenheit(t)),temps.push(isNaN(t)?e:t)}else temps.push(e)}),values=[],currentTemperatures.length>0){for(let e=0;e<currentTemperatures.length;e++){const t=parseFloat(resInputs[currentTemperatures[e]].value);if(isNaN(t))return void alert("Please enter all resistance values.");values.push(t)}const e=values["tsm"===currentType?1:0];calculatedCoefficients=[];let t="Temperature (°F), Electrical Resistivity\n";values.forEach((n,r)=>{let a=n/e;const s=document.getElementById("extrapolateCheck");if(s && s.checked && 800===currentTemperatures[r] && r>1){const t=currentTemperatures[r-2],n=currentTemperatures[r-1],s=values[r-2],i=values[r-1],o=(i-s)/(n-t),c=i-o*n,l=800*o+c;values[r]=l;a=l/e}a=parseFloat(a.toFixed(3));let s=temps[r];calculatedCoefficients.push({temp:s,coef:a}),t+=`${s}, ${a.toFixed(3)}\n`}),document.getElementById("resultOutput").innerText=t}}
function importCSV(e){const t=e.trim().split(/\r?\n/);if(t.length<2)return void alert("CSV file does not contain valid data.");const n=[],r=[];for(let e=1;e<t.length;e++){const a=t[e].split(/,|;/);if(a.length>=2){const e=parseFloat(a[0].replace(/"/g,"").trim()),t=parseFloat(a[1].replace(/"/g,"").trim());isNaN(e)||isNaN(t)||(n.push(e),r.push(t))}}if(0===n.length)return void alert("No valid data found in CSV file.");let a="7pt";if(8===n.length)n.includes(220)||n.some(e=>Math.abs(e-220)<1)?a="tsm":a="8pt";else if(7===n.length){n.includes(600)||n.some(e=>Math.abs(e-600)<1)?a="auto":a="7pt"}let s=parseFloat(window.prompt("Enter base resistance value:","1.0"));return isNaN(s)?void alert("Invalid base resistance. Aborting import."):(currentType=a,document.querySelectorAll("input[name='curveType']").forEach(e=>{e.checked=e.value===currentType}),currentTemperatures=[...n],updateGrid(),n.forEach((e,t)=>{resInputs[e]&&(resInputs[e].value=(r[t]*s).toFixed(3)),tempInputs[e]&&(tempInputs[e].value=e)}),"tsm"===currentType&&resInputs[-40]&&resInputs[70]&&!resInputs[-40].value&&(e=parseFloat(resInputs[70].value),isNaN(e)||(resInputs[-40].value=(.92*e).toFixed(3))),void alert(`CSV data imported successfully with base resistance of ${s}.`))}
function findClosestTemperature(e,t){let n=t[0],r=Math.abs(e-n);for(let a=1;a<t.length;a++){const s=Math.abs(e-t[a]);s<r&&(r=s,n=t[a])}return n}
function findBestCurveTypeMatch(e){const t=Object.keys(temperatureSets);let n={curveType:"7pt",mismatches:[],score:Number.MAX_SAFE_INTEGER};return t.forEach(t=>{const r=temperatureSets[t];if(r.length===e.length){const t=[...e].sort((e,t)=>e-t),a=[...r].sort((e,t)=>e-t);let s=[],i=0;for(let e=0;e<t.length;e++){const n=Math.abs(t[e]-a[e]);i+=n,n>3&&s.push({csvTemp:t[e],expectedTemp:a[e]})}(s.length<n.mismatches.length||s.length===n.mismatches.length&&i<n.score)&&(n={curveType:t,mismatches:s,score:i})}}),n}
function exportCSV(){if(!calculatedCoefficients.length)return void alert("Please calculate TFR values first!");let e="Temperature (°F),Electrical Resistivity\n";calculatedCoefficients.forEach(t=>{e+=`${t.temp},${t.coef.toFixed(3)}\n`});const t=new Blob([e],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="tfr_values.csv",document.body.appendChild(r),r.click(),document.body.removeChild(r)}
function setupExtrapolationListeners(){const e=document.getElementById("extrapolateCheck");if(!e)return;e.addEventListener("change",()=>{const t=e.checked;currentTemperatures.includes(800)&&resInputs[800]&&(resInputs[800].readOnly=t,resInputs[800].style.backgroundColor=t?"#f0f0f0":"")})}
function calculateTCR(){const e=parseFloat(document.getElementById("coldRes").value);if(isNaN(e)||e<=0)return void alert("Please enter a valid cold resistance value.");const t=.79/e,n=Math.round(1e3*(1e3*(t-1)/530-3))/1e3;document.getElementById("tcrResult").innerText=`For a cold resistance of ${e.toFixed(3)} Ω, use TCR value: ${n}`;const r=JSON.parse(localStorage.getItem("calculations"))||[];r.push({coldRes:e.toFixed(3),tcrFull:n}),localStorage.setItem("calculations",JSON.stringify(r)),displaySavedCalculations()}
function deleteCalculation(e){const t=JSON.parse(localStorage.getItem("calculations"))||[];t.splice(e,1),localStorage.setItem("calculations",JSON.stringify(t)),displaySavedCalculations()}
function showTFRGuide(){alert("TFR Guide:\n\n1. Select your curve type (7-point is standard)\n2. Enter temperature values if needed\n3. Enter resistance values for each temperature\n4. Click 'Calculate TFR' to generate values\n5. Export to CSV if needed\n\nFor 800°F extrapolation, check the box and the value will be calculated automatically based on the trend of previous points.")}
function loadImages(){document.getElementById("loadingImages").style.display="block";const e=document.getElementById("imageContainer");e.innerHTML="<p id='loadingImages'>Loading images...</p>";const t=document.getElementById("dimensionFilter");t.innerHTML="<option value='all'>All Images</option>";const n="https://api.skrunks.net/images";fetch(n).then(e=>e.json()).then(n=>{if(cachedImages=n,0===n.length)return void(e.innerHTML="<p>No images found in repository.</p>");const r=new Set;n.forEach(e=>{e.dimensions&&r.add(e.dimensions)}),r.forEach(e=>{const n=document.createElement("option");n.value=e,n.textContent=e,t.appendChild(n)}),filterImages("all")}).catch(t=>{console.error("Error loading images:",t),e.innerHTML="<p>Error loading images. Please try again later.</p>"})}
function filterImages(e){const t=document.getElementById("imageContainer");if(t.innerHTML="",0===cachedImages.length)return void(t.innerHTML="<p>No images found in repository.</p>");const n=cachedImages.filter(t=>"all"===e||t.dimensions===e);0===n.length?t.innerHTML="<p>No images match the selected filter.</p>":n.forEach(e=>{const n=document.createElement("div");n.className="image-card";const r=document.createElement("img");r.src=e.url,r.alt=e.name||"Skrunk Image";const a=document.createElement("div");a.className="image-info";const s=document.createElement("p");s.textContent=e.name||"Unnamed Image",e.dimensions&&(s.textContent+=` (${e.dimensions})`);const i=document.createElement("button");i.className="download-btn",i.textContent="Download",i.onclick=()=>{const t=document.createElement("a");t.href=e.url,t.download=e.name||"skrunk_image",t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)},a.appendChild(s),n.appendChild(r),n.appendChild(a),n.appendChild(i),t.appendChild(n)})}
document.addEventListener("DOMContentLoaded",()=>{document.getElementById("tfrNavBtn").addEventListener("click",()=>{showModule("tfrModule"),updateNavButtons("tfrNavBtn"),updateGrid()}),document.getElementById("tcrNavBtn").addEventListener("click",()=>{showModule("tcrModule"),updateNavButtons("tcrNavBtn"),displaySavedCalculations()}),document.getElementById("submitNavBtn").addEventListener("click",()=>{showModule("submitModule"),updateNavButtons("submitNavBtn")}),document.getElementById("imageRepoNavBtn").addEventListener("click",()=>{showModule("imageRepoModule"),updateNavButtons("imageRepoNavBtn"),cachedImages.length||loadImages()}),document.getElementById("darkModeToggle").addEventListener("click",()=>{const e=document.body.classList.contains("dark-mode");localStorage.setItem("darkMode",(!e).toString()),applyDarkMode()}),document.getElementById("tfrGuideButton").addEventListener("click",showTFRGuide),document.getElementById("tempUnitToggle").addEventListener("click",toggleTemperatureUnit),document.getElementById("calcButton").addEventListener("click",calculateTFR),document.getElementById("tcrCalcButton").addEventListener("click",calculateTCR),document.getElementById("importButton").addEventListener("click",()=>{document.getElementById("csvFileInput").click()}),document.getElementById("csvFileInput").addEventListener("change",e=>{if(e.target.files.length>0){const t=new FileReader;t.onload=e=>{importCSV(e.target.result)},t.readAsText(e.target.files[0])}}),document.getElementById("exportButton").addEventListener("click",exportCSV),document.getElementById("dimensionFilter")&&document.getElementById("dimensionFilter").addEventListener("change",e=>{filterImages(e.target.value)}),document.getElementById("refreshImagesBtn")&&document.getElementById("refreshImagesBtn").addEventListener("click",loadImages);const e=document.querySelectorAll("input[name='curveType']");e.forEach(e=>{e.addEventListener("change",()=>{currentType=e.value,currentTemperatures=temperatureSets[currentType],updateGrid()})}),document.getElementById("scrollToTopBtn")&&document.getElementById("scrollToTopBtn").addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}),window.addEventListener("scroll",()=>{const e=document.getElementById("scrollToTopBtn");e&&(window.scrollY>300?e.classList.add("visible"):e.classList.remove("visible"))}),updateGrid(),applyDarkMode(),displaySavedCalculations()});
</script>
</body>
</html>
